(function(t){function e(e){for(var a,c,i=e[0],u=e[1],s=e[2],f=0,d=[];f<i.length;f++)c=i[f],Object.prototype.hasOwnProperty.call(r,c)&&r[c]&&d.push(r[c][0]),r[c]=0;for(a in u)Object.prototype.hasOwnProperty.call(u,a)&&(t[a]=u[a]);l&&l(e);while(d.length)d.shift()();return o.push.apply(o,s||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],a=!0,i=1;i<n.length;i++){var u=n[i];0!==r[u]&&(a=!1)}a&&(o.splice(e--,1),t=c(c.s=n[0]))}return t}var a={},r={app:0},o=[];function c(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=t,c.c=a,c.d=function(t,e,n){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)c.d(n,a,function(e){return t[e]}.bind(null,a));return n},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="/vue-facebook-login/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],u=i.push.bind(i);i.push=e,i=i.slice();for(var s=0;s<i.length;s++)e(i[s]);var l=u;o.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"396d":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a,r=n("2b0e"),o=(n("396d"),n("99af"),n("ac1f"),n("1276"),n("5530")),c=(n("96cf"),n("1da1")),i=n("dba1"),u=n("bc3a"),s=n.n(u),l="".concat("http://localhost:4000","/accounts"),f=new i["a"](null),d={login:p,apiAuthenticate:h,logout:g,getAll:b,getById:_,update:k,delete:w,account:f.asObservable(),get accountValue(){return f.value}};function p(){return v.apply(this,arguments)}function v(){return v=Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:FB.login(function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(console.log("response",e),n=e.authResponse,localStorage.setItem("authResponse",n),n){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,h(n.accessToken);case 7:a=nt.history.current.query["returnUrl"]||"/",nt.push(a);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),{scope:"public_profile,email, pages_show_list, pages_messaging, pages_manage_metadata, pages_read_engagement"});case 1:case"end":return t.stop()}}),t)}))),v.apply(this,arguments)}function h(t){return m.apply(this,arguments)}function m(){return m=Object(c["a"])(regeneratorRuntime.mark((function t(e){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,s.a.post("".concat(l,"/authenticate"),{accessToken:e});case 2:return n=t.sent,a=n.data,f.next(a),O(),t.abrupt("return",a);case 7:case"end":return t.stop()}}),t)}))),m.apply(this,arguments)}function g(){FB.api("/me/permissions","delete",null,(function(){return FB.logout()})),j(),f.next(null),nt.push("/login")}function b(){return s.a.get(l).then((function(t){return t.data}))}function _(t){return s.a.get("".concat(l,"/").concat(t)).then((function(t){return t.data}))}function k(t,e){return y.apply(this,arguments)}function y(){return y=Object(c["a"])(regeneratorRuntime.mark((function t(e,n){var a,r,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,s.a.put("".concat(l,"/").concat(e),n);case 2:return r=t.sent,c=r.data,c.id===(null===(a=f.value)||void 0===a?void 0:a.id)&&(c=Object(o["a"])(Object(o["a"])({},f.value),c),f.next(c)),t.abrupt("return",c);case 6:case"end":return t.stop()}}),t)}))),y.apply(this,arguments)}function w(t){return x.apply(this,arguments)}function x(){return x=Object(c["a"])(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,s.a.delete("".concat(l,"/").concat(e));case 2:e===(null===(n=f.value)||void 0===n?void 0:n.id)&&g();case 3:case"end":return t.stop()}}),t)}))),x.apply(this,arguments)}function O(){var t=JSON.parse(atob(f.value.token.split(".")[1])),e=new Date(1e3*t.exp),n=e.getTime()-Date.now()-6e4,r=FB.getAuthResponse(),o=r.accessToken;a=setTimeout((function(){return h(o)}),n)}function j(){clearTimeout(a)}function C(t,e,n){var a=d.accountValue;if(!a)return n({path:"/login",query:{returnUrl:t.fullPath}});n()}n("caad");function I(){s.a.interceptors.response.use(null,(function(t){var e,n=t.response;if(n){[401,403].includes(n.status)&&d.accountValue&&d.logout();var a=(null===(e=n.data)||void 0===e?void 0:e.message)||n.statusText;console.error("ERROR:",a)}else console.error(t)}))}n("4de4"),n("7db0"),n("4160"),n("d81d"),n("b0c0"),n("d3b7"),n("8a79"),n("466d");var S=n("2909"),E="vue-facebook-login-accounts",R=JSON.parse(localStorage.getItem(E))||[];function T(){var t=["get","post","put","delete"];t.forEach((function(t){s.a["original".concat(t)]=s.a[t],s.a[t]=function(e){for(var n=arguments.length,a=new Array(n>1?n-1:0),r=1;r<n;r++)a[r-1]=arguments[r];return new Promise((function(n,r){return c();function c(){switch(!0){case e.endsWith("/accounts/authenticate")&&"post"===t:return i();case e.endsWith("/accounts")&&"get"===t:return u();case e.match(/\/accounts\/\d+$/)&&"get"===t:return l();case e.match(/\/accounts\/\d+$/)&&"put"===t:return f();case e.match(/\/accounts\/\d+$/)&&"delete"===t:return p();default:return s.a["original".concat(t)](e,b()).then((function(t){return n(t)})).catch((function(t){return r(t)}))}}function i(){var t=b(),e=t.accessToken;s.a.get("https://graph.facebook.com/v8.0/me?access_token=".concat(e)).then((function(t){var e=t.data;if(e.error)return h(e.error.message);var n=R.find((function(t){return t.facebookId===e.id}));return n||(n={id:_(),facebookId:e.id,name:e.name,extraInfo:"This is some extra info about ".concat(e.name," that is saved in the API")},R.push(n),localStorage.setItem(E,JSON.stringify(R))),v(Object(o["a"])(Object(o["a"])({},n),{},{token:k(n)}))}))}function u(){return m()?v(R):h()}function l(){if(!m())return h();var t=R.find((function(t){return t.id===g()}));return v(t)}function f(){if(!m())return h();var t=b(),e=R.find((function(t){return t.id===g()}));return Object.assign(e,t),localStorage.setItem(E,JSON.stringify(R)),v(e)}function p(){return m()?(R=R.filter((function(t){return t.id!==g()})),localStorage.setItem(E,JSON.stringify(R)),v()):h()}function v(t){setTimeout((function(){return n({status:200,data:t})}),500)}function h(){setTimeout((function(){var t={status:401,data:{message:"Unauthorized"}};r(t);var e=s.a.interceptors.response.handlers[0].rejected;e({response:t})}),500)}function m(){return d.accountValue}function g(){var t=e.split("/");return parseInt(t[t.length-1])}function b(){if(["post","put"].includes(t))return a[0]}function _(){return R.length?Math.max.apply(Math,Object(S["a"])(R.map((function(t){return t.id}))))+1:1}function k(t){var e={exp:Math.round(new Date(Date.now()+9e5).getTime()/1e3),id:t.id};return"fake-jwt-token.".concat(btoa(JSON.stringify(e)))}}))}}))}var $="932010011091655";function A(){return new Promise((function(t){window.fbAsyncInit=function(){FB.init({appId:$,cookie:!0,xfbml:!0,version:"v8.0"}),FB.getLoginStatus((function(e){var n=e.authResponse;n?d.apiAuthenticate(n.accessToken).then(t):t()}))},function(t,e,n){var a,r=t.getElementsByTagName(e)[0];t.getElementById(n)||(a=t.createElement(e),a.id=n,a.src="https://connect.facebook.net/en_US/sdk.js",r.parentNode.insertBefore(a,r))}(document,"script","facebook-jssdk")}))}n("2ca0");function P(){s.a.interceptors.request.use((function(t){var e=d.accountValue,n=null===e||void 0===e?void 0:e.token,a=t.url.startsWith("http://localhost:4000");return n&&a&&(t.headers.common.Authorization="Bearer ".concat(e.token)),t}))}var F=n("8c4f"),B=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("h2",[t._v("You're logged in with Vue.js & Facebook!!")]),n("p",[t._v("All accounts from secure api end point:")]),n("table",{staticClass:"table table-striped"},[t._m(0),n("tbody",[t._l(t.accounts,(function(e){return n("tr",{key:e.id},[n("td",[t._v(t._s(e.id))]),n("td",[t._v(t._s(e.facebookId))]),n("td",[t._v(t._s(e.name))]),n("td",[t._v(t._s(e.extraInfo))]),t._m(1,!0)])})),t.accounts?t._e():n("tr",[t._m(2)])],2)])])},N=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("thead",[n("tr",[n("th",[t._v("Id")]),n("th",[t._v("Facebook Id")]),n("th",[t._v("Name")]),n("th",[t._v("Extra Info")]),n("th",[t._v("Actions")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("td",[n("button",[t._v(" Connect With Facebook Pages ")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("td",{staticClass:"text-center",attrs:{colspan:"5"}},[n("span",{staticClass:"spinner-border spinner-border-lg align-center"})])}],J={data:function(){return{accounts:null}},created:function(){var t=this;d.getAll().then((function(e){return t.accounts=e}))},methods:{deleteAccount:function(t){var e=this;this.accounts=this.accounts.map((function(e){return e.id===t&&(e.isDeleting=!0),e})),d.delete(t).then((function(){return e.accounts=e.accounts.filter((function(e){return e.id!==t}))}))}}},V=J,M=n("2877"),D=Object(M["a"])(V,B,N,!1,null,null,null),U=D.exports,L=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("h2",[t._v("Edit Account")]),n("p",[t._v("Updating the information here will only change it inside this application, it won't (and can't) change anything in the associated Facebook account.")]),t.account?n("form",{on:{submit:function(e){return e.preventDefault(),t.handleSubmit(e)}}},[n("div",{staticClass:"form-group"},[n("label",[t._v("Facebook Id")]),n("div",[t._v(t._s(t.account.facebookId))])]),n("div",{staticClass:"form-group"},[n("label",[t._v("Name")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.account.name,expression:"account.name"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.account.name},on:{input:function(e){e.target.composing||t.$set(t.account,"name",e.target.value)}}})]),n("div",{staticClass:"form-group"},[n("label",[t._v("Extra Info")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.account.extraInfo,expression:"account.extraInfo"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.account.extraInfo},on:{input:function(e){e.target.composing||t.$set(t.account,"extraInfo",e.target.value)}}})]),n("div",{staticClass:"form-group"},[n("button",{staticClass:"btn btn-primary",attrs:{type:"submit",disabled:t.loading}},[t.loading?n("span",{staticClass:"spinner-border spinner-border-sm mr-1"}):t._e(),t._v(" Save ")]),n("router-link",{staticClass:"btn btn-link",attrs:{to:"../../"}},[t._v("Cancel")]),t.error?n("div",{staticClass:"alert alert-danger mt-3 mb-0"},[t._v(t._s(t.error))]):t._e()],1)]):t._e(),t.account?t._e():n("div",{staticClass:"text-center p-3"},[n("span",{staticClass:"spinner-border spinner-border-lg align-center"})])])},W=[],q={data:function(){return{account:null,loading:!1,error:""}},created:function(){var t=this;d.getById(this.$route.params.id).then((function(e){return t.account=e}))},methods:{handleSubmit:function(){var t=this;this.loading=!0,this.error="",d.update(this.$route.params.id,this.account).then((function(){nt.push("../")})).catch((function(e){t.error=e,t.loading=!1}))}}},z=q,H=Object(M["a"])(z,L,W,!1,null,null,null),Y=H.exports,G=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"col-md-6 offset-md-3 mt-5 text-center"},[n("div",{staticClass:"card"},[n("h4",{staticClass:"card-header"},[t._v("Vue.js Facebook Login Example")]),n("div",{staticClass:"card-body"},[n("button",{staticClass:"btn btn-facebook",on:{click:t.login}},[n("i",{staticClass:"fa fa-facebook mr-1"}),t._v(" Login with Facebook ")])])])])},K=[],Q={created:function(){d.accountValue&&nt.push("/")},methods:{login:d.login}},X=Q,Z=Object(M["a"])(X,G,K,!1,null,null,null),tt=Z.exports;r["a"].use(F["a"]);var et=[{path:"/",component:U,beforeEnter:C},{path:"/edit/:id",component:Y,beforeEnter:C},{path:"/login",component:tt},{path:"*",redirect:"/"}],nt=new F["a"]({mode:"history",linkActiveClass:"active",routes:et}),at=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.account?n("nav",{staticClass:"navbar navbar-expand navbar-dark bg-dark"},[n("div",{staticClass:"navbar-nav"},[n("router-link",{staticClass:"nav-item nav-link",attrs:{to:"/"}},[t._v("Home")]),n("a",{staticClass:"nav-item nav-link",on:{click:t.logout}},[t._v("Logout")])],1)]):t._e(),n("div",{staticClass:"container pt-4"},[n("router-view")],1)])},rt=[],ot={data:function(){return{account:null}},created:function(){var t=this;d.account.subscribe((function(e){return t.account=e}))},methods:{logout:d.logout}},ct=ot,it=Object(M["a"])(ct,at,rt,!1,null,null,null),ut=it.exports;function st(){new r["a"]({router:nt,render:function(t){return t(ut)}}).$mount("#app")}T(),P(),I(),A().then(st)}});
//# sourceMappingURL=app.0fcee2cc.js.map